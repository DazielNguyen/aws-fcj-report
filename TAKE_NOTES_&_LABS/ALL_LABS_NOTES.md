# **Module 01 - Lab: 000001 - Thiết lập Tài Khoản AWS**
https://000001.awsstudygroup.com/vi/
## 1. Tạo tài khoản AWS: 
- Tạo tài khoản để truy cập và sử dụng các dịch vụ của AWS, mỗi tài khoản là -> root user
- Root user có toàn quyền với tài khoản AWS của mình, quyền hạn của root user không bị giới hạn. 
- Các điểm lưu ý khi tạo tài khoản: 
    + Cần một tài khoản email: 
    + Một tài khoản ngân hàng có thể dùng quốc tế như Visa. Mastercard để đăng kí được Free Tier của AWS. 
## 2. MFA cho tài khoản AWS. 
- MFA là gì? 
    + MFA (Multi-factor Authentication): Là một chức năng bảo mật có thể thông qua một ứng dụng, cung cấp mã số như OTP để xác thực mỗi lần đăng nhập để an toàn bảo mật
    + OTP(One-time Password): Gồm 6 chữ số và mỗi OTP chỉ có giá trị trong 60 giây.
    + Có thể cài thẳng lên trình duyệt như Microsoft Authentication. 
    + Có thể tham khảo thêm thiết bị MFA Cứng
- Lưu ý: Không nên xóa khóa MFA, khi mất tài khoản rất khó để lấy lại, phải cần đến đội ngũ AWS Support hỗ trợ
## 3. Tạo Admin Group và Admin User
Hướng dẫn tạo Admin Group và Admin User
- **IAM Group:** là một tool quản lý người dùng (IAM User), IAM Group -> Chứa nhiều IAM User, Các IAM User ở trong IAM Group đều hưởng chung quyền hạn mà IAM Group gán cho. 
    + *Hướng dẫn tạo Admin Group:*
        1. Đăng nhập vào AWS Manage Console -> https://aws.amazon.com/
        2. Nhấn vào tên tài khoản ở GÓC PHẢI -> Nhấn chọn **My Security Credentials**
        3. Trong Nagivation pane bên trái -> Chọn **User Groups** -> Nhấn **Create Group** 
    - Lưu ý: 
        + Nếu không thấy **My Security Credentials**
        + Bấm vào thanh tìm kiếm
        + Chọn dịch vụ **IAM**
        + Truy cập vào **IAM Console** 
        + Trong Nagivation pane bên trái -> Chọn **User Groups** -> Nhấn **Create Group** 
    
- **IAM User:** là đơn vị người dùng của AWS, có thể tạo nhiều IAM User để cho phép người khác truy cập dài hạn vào tài nguyên AWS trong tài khoản root AWS.
    + *Hướng dẫn tạo Admin User:*
        1. Đăng nhập vào AWS Manage Console -> https://aws.amazon.com/
        2. Nhấn vào tên tài khoản ở GÓC PHẢI -> Nhấn chọn **My Security Credentials**
        3. Trong Nagivation pane bên trái -> Chọn **User** -> Nhấn **Create User** 
        4. Đặt tên cho User -> Click vào ô **Provide user access to the AWS Management Console...**
        5. Click vào **I want to create an IAM user** -> **Autogenerated Password**
        6. Chọn **Group** vừa tạo. 
        7. Trong phần **Tags** -> Set Key **"User"** -> Set Value **"Admin"**
    + Lưu ý: 
        + Nếu không thấy **My Security Credentials**
        + Bấm vào thanh tìm kiếm
        + Chọn dịch vụ **IAM**
        + Truy cập vào **IAM Console** 
        + Trong Nagivation pane bên trái -> Chọn **User** -> Nhấn **Create User** 
    + Tạo MFA và Access Key cho User
### Quan trọng: 
- Trong AWS khi bạn tạo bất cứ dịch vụ hay thứ gì đều có phần Review lại những thứ mà bạn đã tạo. Và những bảo mật sẽ có được lưu trữ thành một file .csv bạn có thể lưu về để lưu trữ. 
- Lưu ý khi xóa một chức năng bảo mật nào đó cần phải **Deactive** trước rồi mới nhấn **Delete**.
## 4. Hỗ trợ xác thực tài khoản
- AWS Support là đơn vị cung cấp các dịch vụ hỗ trợ khách hàng.
1. Kiểm tra các thông tin: 
    - Kiểm tra lại thông tin tài khoản đã đăng nhập chính xác hay chưa?
    - Nhập đúng thông tin số điện thoại và mã vùng quốc tế chính xác để nhận cuộc gọi xác từ AWS
    - Nếu dùng điện thoại di động, kiểm tra điện thoại có nằm trong vùng phủ sóng để nhận cuộc gọi hay không. 
    - Thông tin về phương thức thanh toán đã được nhập chính xác. 
2. Tạo case hỗ trợ với AWS Support. 
    - Truy cập vào AWS **Support console** -> Chọn **Create Case** 
    - Chọn **Account and billing support** và nhập các thông tin hỗ trợ:
        + Type: chọn **Account**.
        + Category: chọn **Activation**.
        + Subject: viết ngắn gọn tình trạng gặp phải của bạn (VD: **Did not receive an SMS message or call for verification**)
        + Description: Cung cấp chi tiết tình trạng gặp phải và thông tin về thời gian bạn cần hỗ trợ kích hoạt tài khoản.
        + Attachments: Đính kèm hình ảnh mô tả bước xác thực đang vướng phải, nên chụp màn hình lại để người ta hỗ trợ nhanh hơn. 
    - Ở **Contact Options**, chọn **Chat** ở **Contact Methods**, chọn **Submit**, đội ngữ AWS Support sẽ hỗ trợ trực tiếp onlline 24/7 

# **Module 01 - Lab: 000007 - Quản lý chi phí với AWS Budget**
https://000007.awsstudygroup.com/vi/

## 1. Tạo Budget: 
- **AWS Budget** là một dịch vụ cung cấp khả năng thiết lập ngân sách để gửi cảnh báo cho mình khi mình dùng vượt quá chi phí của mình.
- Quản lí chi phí là một việc quan trọng hàng đầu trong việc vận hành hệ thống của mình trên Cloud 
- Nó gồm 4 loại: 
    + **Cost Budget:** 
    + **Usage Budget:** 
    + **RI Budget(Reservation Instance Budget):**  
    + **Saving Plans Budget:**
- Nó sẽ có template để set up phần Budget này. 
## 2. Tạo Cost Budget:
- **Cost Budget:** 
    + Gửi cảnh báo khi tổng chi phí vượt quá ngưỡng chi phí trong ngân sách. Có thể thông qua email. 
    + Vd: Khi ngân sách của mình chỉ có $25 nhưng mức dịch vụ mình sử dụng gần mức $25 đó, chẳng hạn như $20 thì nó sẽ gửi email cảnh báo mình.  
- **Hướng dẫn sử dụng**: 
    + Bước 1: Tìm **Billing and Cost Management** tại thanh tìm kiếm.
    + Bước 2: Chọn **Budgets** từ menu bên trái: 
    + Bước 3: Nhấn **Create Budgets**
- **Thiết lập cấu hình Budgets:**
    + Bước 1: Phần **Budget Setup**, chọn **Customize**
    + Bước 2: Phần **Budget Types**, chọn **Cost budget**
    + Bước 3: Phần **Detail**, tại **Budget name**, nhập "Monthly"
    + Bước 4: Phần **Set budget amount** -> Chọn **Recuring Budget**
        + **Recuring Buget**: Nếu bạn muốn Budget được lặp lại định kỳ
        + **Expiring Budget**: Nếu bạn chỉ muốn Budget được áp dụng một lần duy nhất
    + Bước 5: Chọn **Fixed**, rồi nhập Budget mong muốn 
    + Bước 6: Phần **Configure alerts**, chọn **Add an alert threshold** để thiết lập ngưỡng cảnh báo. Nhấn **Next**.
    + Bước 7: Qua phần set up **Alert #1**, Nhập **Email recipt** để nhận cảnh báo nếu dùng quá mức dịch vụ 
## 3. Tạo Usage Budget: 
- **Usage Budget:** 
    + Gửi cảnh báo khi tổng mức sử dụng **theo từng dịch vụ** bạn lựa chọn vượt qua ngưỡng mức độ sử dụng trong ngân sách. 
    + Vd: Mức độ sử dụng theo số giờ chạy của dịch cụ EC2. Cụ thể như tôi chỉ đặt mức thời gian cho dịch vụ EC2 chỉ được chạy trong 30 giờ thì dịch vụ đó chỉ được chạy trong khoảng thời gian được đặt ra và không được quá cái thời gian đặt ra đó. 
- **Hướng dẫn sử dụng**
    + Thì nó sẽ set up tương tự như **Cost Budget**.
    + Điểm khác biệt thì nó sẽ cảnh báo trên mức tài nguyên mà mình sử dụng thay vì tiền. 
## 4. Tạo RI Budget: 
+ **RI Budget(Reservation Instance Budget):** 
        + Gửi cảnh báo dựa trên mức sử dụng các dịch vụ trả trước *(reservation instance)* của bạn. 
        + Để hiểu rõ hơn đó là một phương pháp giảm chi phí sử dụng instance bằng cách cho phép bạn trả trước hoặc cam kết mức sử dụng của instance theo thời hạn 1 - 3 năm. 
## 5. Tạo Saving Plan Budget:
- **Saving Plans Budget:**
    + Gửi cảnh báo dựa trên mức sử dụng các dịch vụ đã được quy định ở trong saving plans. 
    + Nó cũng gần giống như **Ri Budget** cho phép bạn trả trước hoặc cam kết dài hạn từ 1 - 3 năm mức sử dụng của instance đó
    + **Savings plans instance** là mô hình được ra đời sau và có tính **linh hoạt** hơn **Reserve Instance** với mức giảm giá tương đương. 
    + Khuyến khích sử dụng **Saving Instance** với EC2 Intance
## 6. Clean tài nguyên: 
- Khi cần xóa Budget thì nên cần làm gì? 
- Các bước xóa Bugget 
    + Bước 1: Đăng nhập vào **AWS Management Console** và tìm dịch vụ **AWS Billing and Cost Management** tại thanh tìm kiếm.
    + Bước 2: Tại trang quản trị, chọn **Budgets** từ menu bên trái.
    + Bước 3: Thực hiện xóa budget: Chọn Budget cần xóa
    + Bước 4: Nhấn vào nút **Delete**
- Việc xóa **AWS Budgets** không ảnh hưởng đến tài nguyên đang chạy trong tài khoản AWS của bạn. Các budget chỉ là công cụ giám sát và cảnh báo, không kiểm soát trực tiếp việc sử dụng tài nguyên.

# **Module 01 - Lab: 000009 - Yêu cầu Hỗ trợ từ AWS Support**

https://000009.awsstudygroup.com/vi/

## 1. Các gói hỗ trợ của AWS:
- Chia ra 4 gói hỗ trợ khác nhau: 
    + Basic
    + Developer
    + Business
    + Enterprise
### 1.1 Gói Basic (Free) 
- Hỗ trợ 1-1 chat liên quan đến vấn đề tài khoản, vấn đề thanh toán khi gặp lỗi. 
- Giúp kiểm tra tài khoản và các vấn đề về dịch vụ. 
- Diễn đàn hỗ trợ
### 1.2 Gói Developer (Có tính phí)
- Cung cấp được những chức năng mở rộng hơn. 
    + Các chỉ dẫn về best practice
    + **Hỗ trợ xây dựng kiến trúc khối**: Chỉ dẫn cách sử dụng và kết hợp các sản phẩm, tính năng và dịch vụ của AWS. 
    + **Hỗ trợ không giới hạn các yêu cầu hỗ trợ**: được tạo bởi tài khoản gốc (Root User)
### 1.3 Gói Business (Có tính phí)
- Sẽ được nâng cấp hỗ trợ thêm các chức năng cao hơn. 
    + **Chỉ dẫn theo Use-case cụ thể:** Lời khuyên về sự lựa chọn các sản phẩm, tính năng, và dịch vụ của AWS, hỗ trợ tốt nhất cho nhu cầu của bạn. 
    + **AWS Trusted Advisor:** Truy cập đầy đủ vào công cụ tự động khảo sát môi trường AWS của bạn và xác định cơ hội tiết kiệm chi phí, giảm thiểu rủi ro an ninh và tăng cường độ tin cậy và hiệu suất của hệ thống
    + **Hỗ trợ sử dụng AWS Support API:** Tương tác với Support Center và Trusted Advisor qua API để tự động quản lý yêu cầu hỗ trợ và vận hành AWS Trusted Advisor
    + **Hỗ trợ về phần mềm bên thứ ba:** Hỗ trợ hệ điều hành và cấu hình máy ảo Amazon EC2, cùng với hiệu suất của các ứng dụng phổ biến trên nền tảng AWS
    + **Hỗ trợ không giới hạn các yêu cầu hỗ** trợ được tạo bởi tất cả các IAM User
- **Tip**:  Gói Business là lựa chọn phổ biến cho các doanh nghiệp vừa và nhỏ đang vận hành workload sản xuất trên AWS, cung cấp sự cân bằng tốt giữa chi phí và mức độ hỗ trợ.

### 1.4 Gói Enterprise (Có tính phí)
- với khách hàng sử dụng gói **AWS Support Enterprise** sẽ có thêm các đặc quyền về tính năng như sau:
    + **Chỉ dẫn về kiến trúc phần mềm:** Lời khuyên chuyên sâu về cách phối hợp dịch vụ AWS để giải quyết vấn đề về ứng dụng hoặc tải trọng công việc
    + **Quản lý sự kiện hạ tầng:** Phân tích chuyên sâu về use-case của bạn và cung cấp hướng dẫn về quy mô và kiến trúc phù hợp cho sự kiện cụ thể
    + **Technical Account Manager (TAM):** Sự hỗ trợ thường trực từ Technical Account Manager giải quyết các vấn đề liên quan đến tình huống và ứng dụng của bạn
    + **Ưu tiên và chăm sóc đặc biệt cho các yêu cầu hỗ trợ**
    + **Đánh giá Quản lý Doanh nghiệp:** Hỗ trợ đánh giá toàn diện về chiến lược cloud và tối ưu hóa chi phí
- **Security Note**: Gói Enterprise cung cấp quyền truy cập vào các chuyên gia bảo mật AWS, giúp đảm bảo môi trường cloud của bạn tuân thủ các tiêu chuẩn bảo mật và quy định nghiêm ngặt nhất.
## 2. Truy cập AWS Support: 
- Hỗ trợ Tài khoản và Thanh toán (Account and Billing Support)
    + Loại hỗ trợ này được cung cấp cho tất cả người dùng AWS, bao gồm cả gói hỗ trợ Basic. Bạn có thể nhận được hỗ trợ cho các vấn đề liên quan đến:

        + Câu hỏi về hóa đơn và thanh toán
        + minh tài khoản
        + Thay đổi thông tin tài khoản
        + Các vấn đề về thuế

- Hỗ trợ nâng hạn mức dịch vụ (Service limit increase)
    + Loại yêu cầu này được hỗ trợ cho tất cả người dùng AWS và cho phép bạn yêu cầu tăng giới hạn mặc định của các dịch vụ AWS.

- Hỗ trợ Kỹ thuật (Technical support)
    + Các yêu cầu kỹ thuật giúp giải quyết các vấn đề liên quan đến dịch vụ AWS hoặc ứng dụng bên thứ ba chạy trên AWS. Tùy thuộc vào gói hỗ trợ của bạn:
        + **Gói Developer:** Hỗ trợ qua email hoặc web portal của AWS Support Center
        + **Gói Business/Enterprise:** Hỗ trợ qua email, web portal, chat trực tuyến và điện thoại 24/7 
## 3. Quản lý Yêu cầu Hỗ trợ: 
 3.1. Khởi tạo Yêu cầu Hỗ trợ: 
 - Hướng dẫn chi tiết về cách tạo yêu cầu hỗ trợ mới, bao gồm cách điền thông tin liên quan và mô tả vấn đề một cách hiệu quả để nhận được hỗ trợ nhanh chóng.

 3.2. Lựa chọn mức độ nghiêm trọng (Severity) khi gửi yêu cầu: 
 - Giải thích về các mức độ nghiêm trọng khác nhau và cách chọn mức độ phù hợp với tình huống cụ thể, giúp đảm bảo vấn đề được xử lý theo đúng mức độ ưu tiên.

# **Module 02 - Lab: 000003** - Bắt đầu với Amazon Virtual Private Cloud (VPC) và AWS Site-to-Site VPN

## Link: https://000003.awsstudygroup.com/vi/
- Khởi tạo VPC
    + Cấu hình tường lửa VPC 
    + Thực hành tạo 1 VPC
    + Cấu hình Site to Site VPN

### 1. Các bước thực hành
#### 1.1 Tạo VPC.
- Tạo môi trường mạng ảo riêng biệt trong AWS
- Thiết lập không gian địa chỉ IP cho VPC
- Cấu hình các tính năng DNS cơ bản

        Step 1: Truy cập VPC -> Your VPCs -> Nhấn Crete VPC
        |
        Step 2: Cấu hình VPC
                + Resources: Chọn VPC only
                + Name tag: Nhập ASG
                + IPv4 CIDR: Nhập 10.10.0.0/16
        |
        Step 3: Kích hoạt DNS cho VPC
                + Chọn Edit VPC settings
                + Mở tab DNS settings
                + Bật Enable DNS resolution
                + Bật Enable DNS hostnames
                + Bật Enable Network Address Usage metrics
                + Lưu thay đổi
    
#### 1.2 Tạo Subnets.
- Subnet là phân đoạn mạng con trong VPC
- Cho phép phân phối tài nguyên theo vùng sẵn sàng (AZ)
- Hỗ trợ phân loại mạng public và private

        Step 1: Truy cập VPC -> Subnets -> Nhấn Create Subnet
        |
        Step 2: Chọn VPC ASG đã tạo trước đó. 
        |
        Step 3: Cấu hình Subnet đầu tiên - Public Subnet 1
        |       + Subnet name: Nhập Public Subnet 1
        |       + Availability Zone: Chọn ap-southeast-1a
        |       + IPv4 Subnet CIDR: Nhập 10.10.1.0/24
        |       + Click Create subnet
        |
        Step 4: Tạo Public Subnet 2
        |       + Subnet name: Nhập Public Subnet 2
        |       + Availability Zone: Chọn ap-southeast-1b
        |       + IPv4 Subnet CIDR: Nhập 10.10.2.0/24
        |       + Click Create subnet
        |
        Step 5: Tạo Private Subnet 1
        |       + Subnet name: Nhập Private Subnet 1
        |       + Availability Zone: Chọn ap-southeast-1a
        |       + IPv4 Subnet CIDR: Nhập 10.10.3.0/24
        |       + Click Create subnet
        |
        Step 6: Tạo Private Subnet 2
        |       + Subnet name: Nhập Private Subnet 2
        |       + Availability Zone: Chọn ap-southeast-1b
        |       + IPv4 Subnet CIDR: Nhập 10.10.4.0/24
        |       + Click Create subnet
        |
        Step 7: Cấu hình Auto-assign Public IP -> Mục đích: Cho phép tự động cấp phát địa chỉ IP công cộng cho các instance trong public subnet.
        |       + Chọn subnet từ danh sách -> Set up từng cái Subnet theo các bước dưới
        |       + Click Actions
        |       + Chọn Edit subnet settings
        |       + Bật Enable auto-assign public IPv4 address
        |       + Click Save

***Khi tạo Subnet***
- Sự khác biệt giữa các IP ở mỗi Subnet là khác nhau, và AZ,  nếu không để ý thì dễ bị nhầm lẫn

***Lưu ý về Availability Zone AWS sử dụng hai khái niệm:***

- **Availability Zone (AZ):** Tên hiển thị (ví dụ: ap-southeast-1a)
- **AZ ID:** Định danh thực tế của AZ AWS ánh xạ ngẫu nhiên AZ với AZ ID giữa các tài khoản để đảm bảo phân phối tài nguyên đồng đều.

#### 1.3 Tạo Internet Gateway
- Internet Gateway (IGW) là thành phần VPC cho phép kết nối internet
- Cung cấp điểm kết nối giữa VPC và internet
- Hỗ trợ giao tiếp hai chiều cho các tài nguyên trong VPC

        Step 1: Truy cập VPC -> Internet Gateway -> Nhấn Crete Internet Gateway
        |
        Step 2: Cấu hình Internet Gateway
        |       + Name tag: Nhập Internet Gateway
        |       + Click Create internet gateway
        Step 3: Kết nối với VPC 
        |       + Click Actions trong Internet Gateway
        |       + Chọn Attach to VPC
        |       + Chọn VPC ASG từ danh sách (VPC ID sẽ tự động điền)
        |       + Click Attach internet gateway.

***Xác nhận trạng thái sau khi gắn thành công:***

- State của Internet Gateway sẽ chuyển sang Attached
- IGW đã sẵn sàng định tuyến lưu lượng internet cho VPC

#### 1.4 Tạo Route Table
- Route Table là thành phần định tuyến lưu lượng mạng trong VPC
- Xác định đường đi cho các gói tin giữa các subnet và internet
- Cho phép kiểm soát luồng dữ liệu vào/ra VPC

        Step 1: Truy cập VPC -> Route tables -> Crete route table
        |
        Step 2: Cấu hình Route Table
        |       + Name: Nhập Route table-Public
        |       + VPC: Chọn VPC ASG (VPC ID sẽ tự động điền)
        |       + Click Create route table
        |
        Step 3: Cấu hình định tuyến -> Thêm route cho Internet Gateway
        |       + Click Actions -> Trong Route table
        |       + Chọn Edit routes
        |
        Step 4: Cấu hình route mới
        |       + Click Add route
        |       + Destination: Nhập 0.0.0.0/0 (đại diện cho internet)
        |       + Target: Chọn Internet Gateway và chọn IGW đã tạo
        |       + Click Save changes
        |
        Step 5: Liên kết với Subnet -> Thiết lập subnet associations
        |       + Chọn tab Subnet associations
        |       + Click Edit subnet associations
        |
        Step 6: Chọn các public subnet
        |       + Mở rộng cột Subnet ID để xem chi tiết
        |       + Chọn cả 2 public subnet đã tạo
        |       + Click Save associations

#### 1.5 Tạo Security Group
- Security Group là tường lửa ảo cho các tài nguyên AWS
- Hoạt động như danh sách kiểm soát truy cập (ACL) ở cấp instance
- Cho phép kiểm soát lưu lượng vào/ra theo port và protocol

***Tạo Security Group cho Public Subnet***

        Step 1: Truy cập VPC -> Security Group -> Crete Security Group
        |
        Step 2: Cấu hình Security Group
        |       + Security Group name: Nhập Public subnet - SG
        |       + Description: Nhập Allow SSH and Ping for servers in public subnet
        |       + VPC: Chọn VPC ASG
        |
        Step 3: Thiết lập Inbound Rules
        |       + Click Add rule
        |       + Rule 1:
        |               Type: SSH
        |               Source: My IP (địa chỉ IPv4 public của bạn)
        |       + Rule 2:
        |               Type: All ICMP - IPv4
        |               Source: Anywhere (cho phép ping từ mọi nơi)
        | 
        Step 4: Xác nhận Outbound Rules và tạo Security Group
        |
        Step 5: Kiểm tra Security Group đã tạo

***Tạo Security Group cho Public Subnet***

        Step 1: Truy cập VPC -> Security Group -> Crete Security Group
        |
        Step 2: Cấu hình Security Group
        |       + Security Group name: Nhập Private subnet - SG
        |       + Description: Nhập Allow SSH and Ping for servers in private subnet
        |       + VPC: Chọn VPC ASG
        |
        Step 3: Thiết lập Inbound Rules cho SSH
        |       + Click Add rule
        |       + Type: SSH
        |       + Source: Custom
        |       + Chọn Security Group Public subnet - SG
        |
        Step 4: Thêm rule cho ICMP
        |       + Click Add rule
        |       + Type: All ICMP - IPv4
        |       + Source: Anywhere
        |  
        Step 5: Xác nhận Outbound Rules và tạo Security Group
        |
        Step 6: Kiểm tra Security Group đã tạo

***Cấu hình Security Group cho VPC Endpoints***

        Step 1: Tạo security group bổ sung cho VPC endpoints:
        |       + Quay lại Security Groups
        |       + Nhấp Create security group
        |       + Security group name: Nhập VPC-Endpoints-SG
        |       + Description: Nhập Security group for VPC endpoints
        |       + VPC: Chọn VPC ASG từ dropdown
        | 
        Step 2: Cấu hình quy tắc security group cho VPC Endpoints:
        |       - Inbound rules:
        |         + Nhấp Add rule
        |         + Type: Chọn HTTPS
        |         + Source: Chọn Custom và nhập 10.10.0.0/16 (VPC CIDR)
        |         + Description: Nhập HTTPS access from VPC resources
        |       - Outbound rules: Giữ mặc định (Cho phép tất cả traffic)
        |       - Nhấp Create security group
        |
        Step 3: Cập nhật Private Subnet Security Group để truy cập VPC endpoint:
        |       - Chọn Private subnet - SG
        |       - Nhấp Actions > Edit outbound rules
        |       - Đảm bảo quy tắc outbound sau tồn tại:
        |         + Type: HTTPS
        |         + Destination: 0.0.0.0/0
        |         + Description: HTTPS to AWS services and VPC endpoints
        |       - Nhấp Save rules

***Xác nhận Cấu hình:***

- Kiểm tra ba Security Groups đã tạo: 
   + **Public subnet - SG**: Cho phép SSH từ IP của bạn và ICMP từ VPC 
   + **Private subnet - SG**: Cho phép SSH từ Public subnet và ICMP từ VPC 
   + **VPC-Endpoints-SG**: Cho phép HTTPS từ VPC để truy cập AWS services
#### 1.6 Kích hoạt Flow Logs
***Kích hoạt VPC Flow Logs để Giám sát Bảo mật***

**VPC Flow Logs là gì?**
- VPC Flow Logs ghi lại thông tin về lưu lượng IP đi vào và ra khỏi các network interface trong VPC của bạn. Dữ liệu này rất quan trọng cho việc giám sát bảo mật, khắc phục sự cố mạng và kiểm toán tuân thủ.

**Hướng dẫn Cấu hình VPC Flow Logs từng bước**
        
        ```
        Step 1. Truy cập giao diện VPC Flow Logs:

        - Điều hướng đến console VPC
        - Chọn Your VPCs từ menu bên trái
        - Chọn VPC ASG của bạn
        - Nhấp vào tab Flow logs
        - Nhấp Create flow log
        
        Step 2. Cấu hình các thiết lập Flow Log:

        - Filter: Chọn All (ghi lại tất cả lưu lượng được chấp nhận, từ chối và toàn bộ)
        - Maximum aggregation interval: Chọn 1 minute (để giám sát chi tiết)
        - Destination: Chọn Send to CloudWatch Logs
        - Destination log group: Nhập /aws/vpc/flowlogs
        - IAM role: Chọn Create a new role (AWS sẽ tạo các quyền cần thiết)

        Step 3. Cấu hình định dạng log (Tùy chọn - Nâng cao):

        - Log format: Giữ AWS default format cho workshop này
        - Đối với môi trường production, bạn có thể tùy chỉnh định dạng để bao gồm các trường bổ sung
        
        Step 4. Thêm tags để quản lý tài nguyên:

        - Key: Name
        - Value: ASG-VPC-FlowLogs
        - Nhấp Create flow log
        
        Step 5: Xác minh việc tạo Flow Log:

        - Bạn sẽ thấy thông báo thành công
        - Flow Log sẽ xuất hiện trong tab Flow logs với trạng thái Active
        ```


**Hiểu về Dữ liệu Flow Log**

- Định dạng Bản ghi Flow Log -> Mỗi bản ghi flow log chứa các thông tin chính sau:

  + srcaddr, dstaddr: Địa chỉ IP nguồn và đích
  + srcport, dstport: Cổng nguồn và đích
  + protocol: Số protocol (6=TCP, 17=UDP, 1=ICMP)
  + action: ACCEPT hoặc REJECT
  + bytes, packets: Các chỉ số về khối lượng lưu lượng

**Các trường hợp sử dụng Giám sát Bảo mật** 

- VPC Flow Logs cho phép bạn:

  + Phát hiện các mẫu lưu lượng bất thường
  + Xác định cấu hình sai security group
  + Giám sát các nỗ lực rò rỉ dữ liệu
  + Khắc phục sự cố kết nối
  + Đáp ứng yêu cầu tuân thủ

**Truy cập Dữ liệu Flow Log**

        ```
        Step 6. Xem Flow Logs trong CloudWatch:
        - Điều hướng đến console CloudWatch
        - Chọn Log groups từ menu bên trái
        - Tìm và chọn /aws/vpc/flowlogs
        - Nhấp vào một log stream để xem dữ liệu flow thực tế
        ```

**Thực hành Bảo mật Tốt nhất**
- Kích hoạt Flow Logs trên tất cả VPC production và thiết lập CloudWatch alarms cho các hoạt động đáng ngờ như:

  + Khối lượng lớn kết nối bị từ chối
  + Các mẫu lưu lượng ra ngoài bất thường
  + Kết nối đến các địa chỉ IP độc hại đã biết

**Cân nhắc Chi phí**
- VPC Flow Logs phát sinh phí cho việc lưu trữ CloudWatch Logs và nhập dữ liệu. Để tối ưu chi phí:

  + Sử dụng sampling (ghi lại 1 trong N gói tin) cho môi trường lưu lượng cao
  + Thiết lập thời gian lưu trữ log phù hợp
  + Cân nhắc gửi logs đến S3 để lưu trữ dài hạn với chi phí thấp hơn
**Ghi chú Quan trọng**

- Flow Logs không ghi lại dữ liệu thời gian thực; thường có độ trễ vài phút
- Flow Logs không ghi lại lưu lượng đến/từ Amazon DNS servers
- Các truy vấn metadata đến instance metadata service (169.254.169.254) không được ghi lại

### 2. Các vấn đề gặp phải và cách giải quyết vấn đề.
**Không kết nối SSH vào VStudio được?**
1. Test cổng 22 trước. 
nc -vz ec2-54-254-136-81.ap-southeast-1.compute.amazonaws.com 22

Nó sẽ đưa ra cái IP: 115.78.229.21
2. Mở đúng IP trong Security Group

        ```
        EC2 → Instances → chọn instance của bạn → tab Security → click vào Security group.
        Edit inbound rules → Add rule:
        Type: SSH
        Port: 22
        Source: 115.78.229.21/32
        Save.
        ```
3. Nếu "succeeded", SSH luôn:

```
chmod 400 /Users/vananhduy/Downloads/aws-keypair.pem 
ssh -o IdentitiesOnly=yes \
    -i /Users/vananhduy/Downloads/aws-keypair.pem \
    ec2-user@ec2-54-254-136-81.ap-southeast-1.compute.amazonaws.com
```



# **Module 02 - Lab: 000058** - Làm việc với Amazon System Manager - Session Manager
## Link: https://000058.awsstudygroup.com/vi/
 - System Manager - Session Manager 
    + Tạo kết nối đến máy chủ EC2
    + Quản lí sessioin logs
    + Sử tính năng Port Forwarding
### 1. Các khái niệm mới trong bài LAB: 

#### **Session Manager**

- **Session Manager** là một chức năng nằm trong dịch vụ System Manager của AWS, Session Manager cung cấp khả năng quản lý các máy chủ một cách an toàn mà **không cần mở port SSH, không cần Bastion Host hoặc quản lý SSH key.** 

- **Session Manager** cũng giúp dễ dàng tuân thủ các chính sách của công ty yêu cầu quyền truy cập có kiểm soát, đảm bảo việc bảo mật nghiêm ngặt và ghi log truy việc truy cập trong khi vẫn cung cấp cho người dùng cuối quyền truy cập đa nền tảng.

- Với việc sử dụng Session Manager, bạn sẽ có được **những ưu điểm** sau:

  + Không cần phải mở cổng 22 cho giao thức SSH.
  + Có thể cấu hình để kết nối không cần đi ra ngoài internet.
  + Không cần quản lý private key của server để kết nối SSH.
  + Quản lý tập trung được user bằng việc sử dụng AWS IAM.
  + Truy cập tới server một cách dễ dàng và đơn giản bằng một cú click chuột.
  + Thời gian truy cập nhanh chóng hơn các phương thức truyền thống như SSH.
  + Hỗ trợ nhiều hệ điều hành khác nhau như Linux, Windows, MacOS.
  + Log lại được các phiên kết nối và các câu lệnh đã thực thi trong lúc kết nối tới server.

- Với những ưu điểm trên, bạn có thể **sử dụng Session Manager** thay vì sử dụng kỹ thuật **Bastion host** giúp chúng ta **tiết kiệm** được **thời gian** và **chi phí** khi quản lý server Bastion.


### 2. Thực hành

#### 1. Tạo **Lab VPC**
        Cấu hình: 
        - Tại mục Resource to create chọn: VPC only
        - Tại mục Name tag điền Lab VPC.
        - Tại mục IPv4 CIDR điền : 10.10.0.0/16.
        - Click Create VPC.

#### 2. Tạo **Public subnet**
        
        Cấu hình
        - Tại mục VPC ID click chọn Lab VPC.
        - Tại mục Subnet name điền Lab Public Subnet.
        - Tại mục Availability Zone chọn Availability zone đầu tiên.
        - Tại mục IPv4 CIRD block điền 10.10.1.0/24
        - Sau đó Enable auto-assign public IPv4 address.
        - Tạo Internet Gateway sau đó Attach vào VPC - Đặt tên Lab IWG
        - Create route table. -> Tên Lab Publicrtb - Chọn Lab VPC
        - Cấu hình Route table đó vào Internet Gatewat 
        - Sau đó Associate Subnet

#### 3. Tạo **Private subnet**

        Cấu hình: 
        - Tại mục VPC ID click chọn Lab VPC.
        - Tại mục Subnet name điền Lab Private Subnet.
        - Tại mục Availability Zone chọn Availability zone đầu tiên.
        - Tại mục IPv4 CIRD block điền 10.10.2.0/24.

#### 4. Tạo các **security group**

        Cấu hình 1: (security group cho Linux instance nằm trong public subnet)
        - Tại mục Security group name, điền SG Public Linux Instance.
        - Tại mục Description, điền SG Public Linux Instance.
        - Tại mục VPC, click dấu X để chọn lại Lab VPC bạn đã tạo cho bài lab này.        

        Cấu hình 2: (Tạo security group cho Windows instance nằm trong private subnet)
        - Tại mục Security group name, điền SG Private Windows Instance.
        - Tại mục Description, điền SG Private Windows Instance.
        - Tại mục VPC, click dấu X để chọn lại Lab VPC bạn đã tạo cho bài lab này.
        - Thêm Outbound rule cho phép kết nối TCP 443 tới 10.10.0.0/16 ( CIDR của Lab VPC chúng ta đã tạo)

        Cấu hình 3: Tạo security group cho VPC Endpoint
        - Tại mục Security group name, điền SG VPC Endpoint.
        - Tại mục Description, điền SG VPC Endpoint.
        - Tại mục VPC, click dấu X để chọn lại Lab VPC bạn đã tạo cho bài lab này
        - Xóa Outbound rule.
        - Thêm Inbound rule cho phép TCP 443 đến từ 10.10.0.0/16 ( CIDR của Lab VPC chúng ta đã tạo ).
#### 5. Tạo Public Linux EC2
[https://000058.awsstudygroup.com/vi/2-prerequiste/2.1-createec2/2.1.5-createec2linux/]

#### 6. Tạo Private EC2 Windows 
[https://000058.awsstudygroup.com/vi/2-prerequiste/2.1-createec2/2.1.6-createec2windows/]

#### 7. Kết nối đến máy chủ Public
[https://000058.awsstudygroup.com/vi/3-accessibilitytoinstances/3.1-public-instance/]

**Note(!!!)**
```
Ở trên, chúng ta đã tạo kết nối vào public instance mà không cần mở cổng SSH 22, giúp cho việc bảo mật tốt hơn, tránh mọi sự tấn công tới cổng SSH.
Một nhược điểm của cách làm trên là ta phải mở Security Group outbound ở cổng 443 ra ngoài internet. Vì là public instance nên có thể sẽ không vấn đề gì nhưng nếu bạn muốn bảo mật hơn nữa, bạn có thể khoá cổng 443 ra ngoài internet mà vẫn sử dụng được Session Manager. Chúng ta sẽ đi qua cách làm này ở phần private instance dưới đây.
```

#### 8. Tạo kết nối đến máy chủ EC2 Private

        ```
        1. Kích hoạt tính năng DNS hostnames trên VPC.
        Truy cập đến giao diện quản trị của dịch vụ VPC
        - Click Your VPCs.
        - Chọn Lab VPC.
        - Click Actions.
        - Click Edit VPC settings.
        - Tại mục DNS setting.
        - Click tick cho Enable DNS hostnames.
        - Click Save.
        ```

#### 9. Tạo VPC Endpoint
- Chúng ta sẽ tạo 3 interface endpoint yêu cầu bởi Session Manager:
- Interface endpoint:
   + com.amazonaws.region.ssm
   + com.amazonaws.region.ec2messages
   + com.amazonaws.region.ssmmessages

   ```
   1. Tạo VPC Endpoint SSM
   [https://000058.awsstudygroup.com/vi/3-accessibilitytoinstances/3.2-private-instance/3.2.2-createvpcendpoint/3.2.2.1-endpointssm/]
   2. Tạo Endpoint ssmmessages

   ```
### 3. Các vấn đề gặp phải và cách giải quyết vấn đề.







# **Module 02 - Lab: 000019**
## Link: https://0000019.awsstudygroup.com/vi/
### 1. Các bước thực hành
### 2. Điểm cần lưu ý: 
### 3. Các vấn đề gặp phải và cách giải quyết vấn đề.
 - Thiết lập VPC Peering
    + Cập nhật Network ACL 
    + Tạo kết nối Peering 
    + Cấu hình Route tables 
    + Kích hoạt Cross-Peer DNS. 

# **Module 02 - Lab: 000020**
## Link: https://000020.awsstudygroup.com/vi/
### 1. Các bước thực hành
### 2. Điểm cần lưu ý: 
### 3. Các vấn đề gặp phải và cách giải quyết vấn đề.
 - Thiết lập Transit Gateway
    + Thiết lập hạ tầng
    + Tạo Transit Gateway -> Nối nhiều VPC lại với nhau
    + Transit Gateway Attachments
    + Tạo Route Table cho TGW
    + Thêm Gateway vào Route Tables & Kiểm tra kết quả

# **Module 02 - Lab: 000010**
## Link: https://000010.awsstudygroup.com/vi/
### 1. Các bước thực hành
### 2. Điểm cần lưu ý: 
### 3. Các vấn đề gặp phải và cách giải quyết vấn đề.
 - Hybrid DNS
    + Thiết lập Hybrid DNS
    + Tạo Outbound Endpoint
    + Tạo Route 53 Resolver Rule
    + Tạo Inbound Endpoint.

